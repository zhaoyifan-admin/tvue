(window.webpackJsonp=window.webpackJsonp||[]).push([[249],{619:function(e,t,i){},672:function(e,t,i){"use strict";i(619)},685:function(e,t,i){"use strict";i.r(t);var a={name:"AvueMap",props:{size:String,placeholder:String,disabled:{type:Boolean,default:!1},value:{type:Object,default:()=>({})}},data:()=>({address:"",poi:{},marker:null,map:null,box:!1}),watch:{value:{handler(e){this.poi=e},deep:!0,immediate:!0},poi:{handler(e){this.$emit("input",e)},deep:!0},text:{handler(e){this.address=e},deep:!0,immediate:!0},box:{handler(){this.box&&this.$nextTick(()=>this.init(()=>{this.longitude&&this.latitude&&(this.addMarker(this.longitude,this.latitude),this.getAddress(this.longitude,this.latitude))}))},immediate:!0}},computed:{longitude(){return this.poi.longitude},latitude(){return this.poi.latitude},text(){return this.poi.formattedAddress},title(){return this.disabled?"查看坐标":"选择坐标"},textTitle(){return this.disabled?this.title:void 0===this.poi.name?"选择坐标":"重新选择"}},methods:{addMarker(e,t){this.clearMarker(),this.marker=new window.AMap.Marker({position:[e,t]}),this.marker.setMap(this.map)},clearMarker(){this.marker&&(this.marker.setMap(null),this.marker=null)},getAddress(e,t){new window.AMap.service("AMap.Geocoder",()=>{new window.AMap.Geocoder({}).getAddress([e,t],(i,a)=>{if("complete"===i&&"OK"===a.info){const i=a.regeocode;this.poi=Object.assign(i,{longitude:e,latitude:t});var s=document.createElement("div"),n=document.createElement("img");n.src="//a.amap.com/jsapi_demos/static/demo-center/icons/poi-marker-default.png",s.appendChild(n);var d=document.createElement("span");d.className="avue-map__marker",d.innerHTML=this.text,s.appendChild(d),this.marker.setContent(s)}})})},handleClose(){window.poiPicker.clearSearchResults()},addClick(){this.map.on("click",e=>{const t=e.lnglat,i=t.P||t.Q,a=t.R;this.addMarker(a,i),this.getAddress(a,i)})},init(e){this.map=new window.AMap.Map("map__container",{zoom:13,center:(()=>{if(this.longitude&&this.latitude)return[this.longitude,this.latitude]})()}),this.initPoip(),this.addClick(),e()},initPoip(){window.AMapUI.loadUI(["misc/PoiPicker"],e=>{var t=new e({input:"map__input",placeSearchOptions:{map:this.map,pageSize:10},searchResultsContainer:"map__result"});this.poiPickerReady(t)})},poiPickerReady(e){window.poiPicker=e,e.on("poiPicked",t=>{this.clearMarker();var i=t.source,a=t.item;this.poi=Object.assign(a,{formattedAddress:a.name,longitude:a.location.R,latitude:a.location.P}),"search"!==i&&e.searchByKeyword(a.name)})}}},s=(i(672),i(1)),n=Object(s.a)(a,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"avue-map"},[t("el-input",{attrs:{readonly:"",size:e.size,placeholder:e.placeholder},model:{value:e.text,callback:function(t){e.text=t},expression:"text"}},[t("el-button",{attrs:{slot:"append"},on:{click:function(t){e.box=!0}},slot:"append"},[e._v(e._s(e.textTitle))])],1),e._v(" "),t("el-dialog",{staticClass:"avue-map__dialog",attrs:{width:"80%","append-to-body":"","modal-append-to-body":"",title:e.title,visible:e.box},on:{close:e.handleClose,"update:visible":function(t){e.box=t}}},[e.box?t("div",{staticClass:"avue-map__content"},[t("el-input",{staticClass:"avue-map__content-input",attrs:{id:"map__input",readonly:e.disabled,clearable:"",placeholder:"输入关键字选取地点"},model:{value:e.address,callback:function(t){e.address=t},expression:"address"}}),e._v(" "),t("div",{staticClass:"avue-map__content-box"},[t("div",{staticClass:"avue-map__content-container",attrs:{id:"map__container",tabindex:"0"}}),e._v(" "),t("div",{staticClass:"avue-map__content-result",attrs:{id:"map__result"}})])],1):e._e()])],1)}),[],!1,null,null,null).exports;n.install=function(e){e.component(n.name,n)};var d=n,o=i(0);const l=[d];function r(e){l.map(t=>{e.component(t.name,t)})}window.Vue?r(window.Vue):r(o.default);t.default=r}}]);